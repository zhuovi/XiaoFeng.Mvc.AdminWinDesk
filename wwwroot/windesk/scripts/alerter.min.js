layui.define(["jquery"],function(n){"use strict";var t=layui.$,i={zIndex:100,anims:["alerter-anim-00","alerter-anim-01","alerter-anim-02","alerter-anim-03","alerter-anim-04","alerter-anim-05","alerter-anim-06"],tips:function(){},msg:function(){},alert:function(){},prompt:function(){},confirm:function(){},open:function(n){return new r(n)},close:function(n,r){if(n){var u=t("dl.alerter[data-index="+n+"]");u.length!=0&&(u.removeClass(i.anims[0]).addClass("alerter-anim-close"),window.setTimeout(function(){u.remove()},1e3),typeof r=="function"&&r())}},closeAll:function(n,r){typeof n=="function"&&(r=n,n=null);var u=n==null?"":"="+n;t("dl.alerter[data-type"+u+"]").each(function(){i.close(t(this).css("z-index"),null)});typeof r=="function"&&r()},show:function(n,r){if(n){var u=t("dl.alerter[data-index="+n+"]"),f=u.attr("data-anim");u.removeClass("alerter-anim-close").addClass(i.anims[f]);u.show();typeof r=="function"&&r()}},hide:function(n,t){i.min(n,t)},restore:function(n,i){typeof n=="function"&&(i=n,n=0);var r="dl.alerter";n>0&&(r+="[data-index="+n+"]");t(r).each(function(){});typeof i=="function"&&i()},min:function(n,i){typeof n=="function"&&(i=n,n=0);var r="dl.alerter";n>0&&(r+="[data-index="+n+"]");t(r).each(function(){t(this).find("dt>a.min").trigger("click")});typeof i=="function"&&i(n)},topWindows:function(n,r){if(n!=i.zIndex){var u=t("dl.alerter[data-index="+n+"]");u.length!=0&&(u.css("z-index",++i.zIndex),u.attr("id","alerter"+i.zIndex),t("dl.alerter").each(function(){var n=t(this).find(".alerter-cover");n.length==0&&t(this).append("<div class='alerter-cover'><\/div>")}),u.find(".alerter-cover").remove(),typeof r=="function"&&r())}},getTopWindow:function(n){var i=[],r;return(n=n||!1,r=n?":visible":"",t("dl.alerter"+r).each(function(){i.push({zIndex:t(this).css("z-index"),dom:t(this)})}),i.length==0)?null:(i.length>1&&i.sort(function(n,t){return t.zIndex-n.zIndex}),console.log(i),i[0].dom)}},r=function(n){var r={area:["500px","500px"],type:0,fixed:!0,offset:"auto",anim:0,resize:!0,time:0,scrollbar:!0,closeBtn:!0,minBtn:!0,maxBtn:!0,skin:"",icon:"",title:"",content:"",shade:0,shadow:!0,moveup:function(){},min:function(){},max:function(){},restore:function(){},close:function(){},resizing:function(){},success:function(){},active:function(){}},u,f;r=t.extend({},r,n);u=i.anims;this.CreateVessel=function(){var w=++i.zIndex,e=++i.zIndex,f,o,y,s,l,p;console.log(r.area);var h=(t(window).width()-parseFloat(r.area[0]))/2,c=(t(window).height()-parseFloat(r.area[1]))/2,a=r.area[0]==0?"auto":r.area[0]+"px",v=r.area[1]==0?"auto":r.area[1]+"px",n=t('<dl id="alerter'+e+'" class="alerter layui-layer '+(r.skin==""?"":" "+r.skin)+(r.anim>=0&&r.anim<=6?" alerter-anim "+u[r.anim]:"")+'" style="z-index:'+e+";left:"+h+"px;top:"+c+"px;width:"+a+";height:"+v+";"+(r.fixed?"position:fixed; ":"")+'" data-time="'+r.time+'" data-type="'+r.type+'" data-anim="'+r.anim+'" data-index="'+e+'"><\/dl>');return t(document.body).append(n),r.title==""||typeof r.title=="boolean"&&r.title==!1||(f=t("<dt>"),n.append(f),r.icon.startsWith("<img")?f.append(t(r.icon)):r.icon.indexOf("/")>-1?f.append(t("<img src='"+r.icon+"'/>")):f.append(t('<i class="'+r.icon+'"><\/i>')),f.append(t("<div class='alerter-title'>"+r.title+"<\/div>")),r.minBtn&&f.append(t('<a href="javascript:void(0);" class="zw-icon min"><\/a>')),r.maxBtn&&f.append(t('<a href="javascript:void(0);" class="zw-icon max"><\/a>')),r.closeBtn&&f.append(t('<a href="javascript:void(0);" class="zw-icon close"><\/a>'))),o=t("<dd><\/dd>"),n.append(o),r.resize&&o.append('<div class="resize-bottom"><\/div>            <div class="resize-right"><\/div>            <div class="resize"><\/div>'),r.type==0?o.append(t('<iframe allowtransparency="true" src="'+r.content+'" width="100%" height="100%" frameborder="0"><\/iframe>')):r.type==1&&(y=r.content,o.append("<div class='alerter-content'>"+y+"<\/div>")),r.shade>0&&(s=t("#alerter-shade"+e),s.length==0&&(s=t('<div class="alerter-shade" id="alerter-shade'+e+'"><\/div>'),t(document.body).append(s)),s.css({"background-color":"rgba(0,0,0,"+r.shade+")","z-index":w})),t("dl.alerter").each(function(){if(t(this).css("z-index")!=e){var n=t(this).find(".alerter-cover");n.length==0&&t(this).append("<div class='alerter-cover'><\/div>")}}),typeof r.success=="function"&&r.success(n,e),a=="auto"&&(l=n.width(),console.log(l),h=(t(window).width()-parseFloat(l))/2,n.css("left",h)),v=="auto"&&(p=n.height(),c=(t(window).height()-parseFloat(p))/2,n.css("top",c)),n};f=this;this.init=function(){var n=this.CreateVessel();this.BindEvent(n)};this.BindEvent=function(n){var e={moveStart:!1,moveResize:!1,dom:[],left:0,top:0,x:0,y:0,width:0,height:0};n.on("mousedown",function(){var n=t(this).attr("data-index");i.topWindows(n);typeof r.active=="function"&&r.active(t(this),n)});n.find(".alerter-title").on("mousedown",function(i){if(i.preventDefault(),i.stopPropagation(),!(t(this).parent().find("a.restore").length>0)){e.moveStart=!0;e.left=parseFloat(n.css("left"));e.top=parseFloat(n.css("top"));e.moveStart=!0;e.x=i.clientX;e.y=i.clientY;e.width=n.outerWidth();e.height=n.outerHeight();var u=null;r.shadow&&(u=t(".alerter-temp"),u.length==0&&(u=t("<div class='alerter-temp'><\/div>"),t(document.body).append(u)),u.css({left:e.left,top:e.top,width:e.width,height:e.height}));t(document).on("mousemove",function(t){var i,f;e.moveStart&&((i=t.clientY-e.y+e.top,i<=0)||(f=t.clientX-e.x+e.left,r.shadow?u.css({left:f,top:i}):n.css({left:f,top:i})))}).on("mouseup",function(){t(document).off("mousemove").off("mouseup");r.shadow&&(n.animate({left:parseFloat(u.css("left")),top:parseFloat(u.css("top"))},200),u.remove());e.moveStart=!1;typeof r.moveup=="function"&&r.moveup(n)})}});n.find(".resize-right").on("mousedown",function(i){i.preventDefault();i.stopPropagation();e.moveResize=!0;e.x=i.clientX;e.width=n.outerWidth();var u=t(".alerter-move");u.length==0?(u=t("<div class='alerter-move'><\/div>"),t(document.body).append(u)):u.show();t(document).bind("mousemove",function(t){if(e.moveResize){var i=t.clientX-e.x+e.width;i<=120||n.css({width:i})}}).bind("mouseup",function(){t(document).off("mousemove").off("mouseup");e.moveResize=!1;u.remove();typeof r.resizing=="function"&&r.resizing(n)})});n.find(".resize-bottom").on("mousedown",function(i){i.preventDefault();i.stopPropagation();e.moveResize=!0;e.y=i.clientY;e.height=n.outerHeight();var u=t(".alerter-move");u.length==0?(u=t("<div class='alerter-move'><\/div>"),t(document.body).append(u)):u.show();t(document).on("mousemove",function(t){if(e.moveResize){var i=t.clientY-e.y+e.height;i<=50||n.css({height:i})}}).on("mouseup",function(){t(document).off("mousemove").off("mouseup");e.moveResize=!1;u.remove();typeof r.resizing=="function"&&r.resizing(n)})});n.find(".resize").on("mousedown.alerter",function(i){i.preventDefault();i.stopPropagation();e.moveResize=!0;e.x=i.clientX;e.y=i.clientY;e.width=n.outerWidth();e.height=n.outerHeight();var u=t(".alerter-move");u.length==0?(u=t("<div class='alerter-move'><\/div>"),t(document.body).append(u)):u.show();t(document).on("mousemove.alerter",function(t){if(e.moveResize){var i=t.clientX-e.x+e.width,r=t.clientY-e.y+e.height;i<=120||r<=50||n.css({width:i,height:r})}}).on("mouseup.alerter",function(){t(document).off("mousemove").off("mouseup");u.remove();e.moveResize=!1;typeof r.resizing=="function"&&r.resizing(n)})});n.on("click",".min",function(){var n=t(this).parents(".alerter");n.removeClass(u[r.anim]).addClass("alerter-anim-close");window.setTimeout(function(){n.hide();typeof r.min=="function"&&r.min(n,n.css("z-index"))},100)}).on("click",".restore",function(){var n,f,i;t(this).removeClass("restore");t(this).addClass("max");n=t(this).parents(".alerter");f=n.attr("data-area")||"";f==""&&(f="100,100,500,500");i=f.split(",");n.css({left:i[0]+"px",top:i[1]+"px",width:i[2]+"px",height:i[3]+"px"});n.removeClass("alerter-anim-close").addClass(u[r.anim]);typeof r.restore=="function"&&r.restore(n,n.css("z-index"))}).on("click",".max",function(){t(this).removeClass("max");t(this).addClass("restore");var n=t(this).parents(".alerter");n.attr("data-area",parseFloat(n.css("left"))+","+parseFloat(n.css("top"))+","+parseFloat(n.css("width"))+","+parseFloat(n.css("height")));n.css({left:0,top:0,width:"100%",height:"100%"});n.removeClass("alerter-anim-close").addClass(u[r.anim]);typeof r.max=="function"&&r.max(n,n.css("z-index"))}).on("click",".close",function(){var n=t(this).parents(".alerter"),i;t("#alerter-shade"+n.css("z-index")).remove();i=f.GetTopWindow();i!=null&&i.find(".alerter-cover").remove();typeof r.close=="function"&&r.close(n,n.css("z-index"));n.removeClass(u[r.anim]).addClass("alerter-anim-close");window.setTimeout(function(){n.remove()},1e3)})};this.GetChildFrame=function(n,i){return t("dl.alerter[data-index="+i+"]").find("iframe").contents().find(n)};this.IframeAuto=function(n){if(n){var i=this.GetChildFrame("html",n),u=i.outerHeight(),f=i.outerWidth(),r=t("dl.alerter[data-index="+n+"]"),e=r.find(".title").outerHeight();r.css({width:f,height:u+e})}};this.GetTopWindow=function(){var n=[];return(t("dl.alerter").each(function(){n.push({zIndex:t(this).css("z-index"),dom:t(this)})}),n.length==0)?null:(n.length>1&&n.sort(function(n,t){return t.zIndex-n.zIndex}),n[0].dom)};this.init()};window.Alerter=i;n("alerter",i)});